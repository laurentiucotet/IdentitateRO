---
/**
 * LogoCard — Card pentru afișarea unui logo în grid (v3.0)
 *
 * Acceptă date din schema v3.0 (structură plată cu slug/name/category).
 */
import { CATEGORY_LABELS_SINGULAR, QUALITY_LABELS } from '../lib/labels';
import { resolveAssetPath, getAssetFallbackUrls } from '../lib/cdn-helpers';

export interface Props {
  slug: string;
  name: string;
  shortname?: string;
  category: string;
  logoPath: string;
  quality?: string;
  hasSvg: boolean;
  keywords?: string[];
}

const { slug, name, shortname, category, logoPath, quality, hasSvg, keywords } = Astro.props;

const displayName = shortname || name;
const qualityInfo = quality ? QUALITY_LABELS[quality] : undefined;
---

<a
  href={`/institution/${slug}`}
  class="logo-card w-1/2 sm:w-1/3 lg:w-1/5 text-left group"
  aria-label={`Vezi detalii pentru ${name}`}
  data-institution-id={slug}
>
  <!-- Logo Preview Area -->
  <div class="checkerboard aspect-square rounded-t flex items-center justify-center p-6 overflow-hidden">
    <img
      src={logoPath}
      alt={`Logo ${name}`}
      class="max-w-full max-h-full object-contain transition-transform duration-200 group-hover:scale-105"
      loading="lazy"
      onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
    />
    <!-- Fallback -->
    <div class="hidden flex-col items-center justify-center text-surface-400">
      <svg class="w-12 h-12 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
      </svg>
      <span class="text-xs">Logo indisponibil</span>
    </div>
  </div>

  <!-- Info Area -->
  <div class="p-3 border-t border-surface-100">
    <div class="flex items-start justify-between gap-2">
      <div class="min-w-0">
        <h3 class="font-semibold text-sm text-primary-900 truncate" title={name}>
          {displayName}
        </h3>
        <span class="text-xs text-surface-500">{CATEGORY_LABELS_SINGULAR[category] || category}</span>
      </div>
    </div>
  </div>
</a>
