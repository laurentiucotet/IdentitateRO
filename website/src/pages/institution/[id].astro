---
import BaseLayout from '../../layouts/BaseLayout.astro';
import institutionIndex from '../../data/institutions-index.json';

export async function getStaticPaths() {
  return institutionIndex.institutions.map(inst => ({
    params: { id: inst.id },
    props: { institution: inst }
  }));
}

const { institution } = Astro.props;

const title = `${institution.name} — IdentitateRO`;
const description = `Logo-uri și identitate vizuală pentru ${institution.name}. ${institution.description || ''}`;
---

<BaseLayout title={title} description={description}>
  <article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Header -->
    <header class="mb-8">
      <div class="flex items-center gap-3 mb-4">
        <a href="/" class="text-primary-500 hover:text-primary-600 text-sm flex items-center gap-1">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
          Înapoi la toate
        </a>
      </div>
      <h1 class="text-2xl sm:text-3xl font-bold text-primary-900 mb-2">{institution.name}</h1>
      {institution.description && (
        <p class="text-sm text-surface-500">{institution.description}</p>
      )}
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- Logo Preview -->
      <section>
        <h2 class="text-lg font-semibold text-primary-900 mb-4">Logo</h2>
        <div class="bg-white border border-surface-200 rounded p-6">
          <div class="checkerboard aspect-square rounded flex items-center justify-center p-6 mb-4">
            {institution.assets.some(a => a.format === 'svg') ? (
              <img
                src={institution.assets.find(a => a.format === 'svg')?.path}
                alt={`Logo ${institution.name}`}
                class="max-w-full max-h-full object-contain"
              />
            ) : (
              <img
                src={institution.assets[0]?.path}
                alt={`Logo ${institution.name}`}
                class="max-w-full max-h-full object-contain"
              />
            )}
          </div>
        </div>
      </section>

      <!-- Downloads & Info -->
      <section>
        <h2 class="text-lg font-semibold text-primary-900 mb-4">Descărcări</h2>
        <div class="space-y-3">
          {institution.assets.map((asset, index) => (
            <a
              href={asset.path}
              download
              class="flex items-center justify-between p-3 bg-white border border-surface-200 rounded hover:border-primary-300 transition-colors group"
            >
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-primary-50 rounded flex items-center justify-center">
                  <svg class="w-4 h-4 text-primary-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                  </svg>
                </div>
                <div>
                  <div class="font-medium text-sm text-primary-900">
                    {asset.variant || 'Principal'} ({asset.format.toUpperCase()})
                  </div>
                  {asset.width && asset.height && (
                    <div class="text-xs text-surface-500">
                      {asset.width} × {asset.height}px
                    </div>
                  )}
                </div>
              </div>
              <svg class="w-4 h-4 text-surface-400 group-hover:text-primary-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
              </svg>
            </a>
          ))}
        </div>

        {institution.resources?.website && (
          <div class="mt-6">
            <a
              href={institution.resources.website}
              target="_blank"
              rel="noopener"
              class="btn-primary inline-flex items-center gap-2"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
              </svg>
              Website Oficial
            </a>
          </div>
        )}
      </section>
    </div>

    <!-- Colors -->
    {institution.colors && institution.colors.length > 0 && (
      <section class="mt-8">
        <h2 class="text-lg font-semibold text-primary-900 mb-4">Paletă de Culori</h2>
        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">
          {institution.colors.map((color, index) => (
            <div class="bg-white border border-surface-200 rounded p-3">
              <div
                class="w-full aspect-square rounded mb-2 border border-surface-200"
                style={`background-color: ${color.hex}`}
              ></div>
              <div class="text-xs">
                <div class="font-medium text-primary-900">{color.name}</div>
                <div class="text-surface-500 font-mono">{color.hex}</div>
                {color.pantone && <div class="text-surface-500">Pantone {color.pantone}</div>}
              </div>
            </div>
          ))}
        </div>
      </section>
    )}

    <!-- Resources -->
    {institution.resources && (institution.resources.brand_manual || institution.resources.font_primary) && (
      <section class="mt-8">
        <h2 class="text-lg font-semibold text-primary-900 mb-4">Resurse Suplimentare</h2>
        <div class="space-y-2">
          {institution.resources.brand_manual && (
            <a
              href={institution.resources.brand_manual}
              target="_blank"
              rel="noopener"
              class="flex items-center gap-2 text-sm text-primary-500 hover:text-primary-600"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
              </svg>
              Manual de Identitate Vizuală
            </a>
          )}
          {institution.resources.font_primary && (
            <div class="flex items-center gap-2 text-sm text-surface-600">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" />
              </svg>
              Font Principal: {institution.resources.font_primary}
            </div>
          )}
        </div>
      </section>
    )}

    <!-- Metadata -->
    <section class="mt-8 pt-6 border-t border-surface-200">
      <div class="text-xs text-surface-500 space-y-1">
        <div>Ultima actualizare: {new Date(institution.updatedAt).toLocaleDateString('ro-RO')}</div>
        <div>Sursă: {institution.source}</div>
        <div>Calitate: {institution.quality}</div>
      </div>
    </section>
  </article>
</BaseLayout>

<style>
  .checkerboard {
    background-image:
      linear-gradient(45deg, #f0f0f0 25%, transparent 25%),
      linear-gradient(-45deg, #f0f0f0 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #f0f0f0 75%),
      linear-gradient(-45deg, transparent 75%, #f0f0f0 75%);
    background-size: 20px 20px;
    background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
  }
</style>